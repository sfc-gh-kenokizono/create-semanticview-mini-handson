# 講師ガイド: セマンティックビュー作成ハンズオン

## ハンズオン概要

| 項目 | 内容 |
|------|------|
| **目的** | セマンティックビューの手動作成とAI支援作成の違いを体験 |
| **対象者** | Snowflake初級〜中級者、データアナリスト、データエンジニア |
| **所要時間** | 約60分 |
| **前提条件** | Snowflakeトライアルアカウント、ACCOUNTADMIN権限 |

---

## タイムスケジュール

| 時間 | フェーズ | 内容 | 講師の役割 |
|------|----------|------|-----------|
| 0:00-0:15 | 導入・セットアップ | 概要説明 + Step 0実行 | 説明 + サポート |
| 0:15-0:45 | Step 1: 手動作成 | GUI操作でセマンティックビュー作成 | 見守り + ヒント |
| 0:45-0:55 | Step 2: AI支援作成 | サンプルSQL入力で自動生成 | デモ or ハンズオン |
| 0:55-1:00 | 振り返り・Q&A | 比較まとめ、質疑応答 | ファシリテーション |

---

## フェーズ別 講師アクション

### 導入（0:00-0:15）

#### 説明ポイント

1. **セマンティックビューとは何か**
   - 「テーブル間の関係性やビジネス用語を定義した"意味のレイヤー"」
   - 「Cortex Analystが自然言語をSQLに変換する際の"辞書"」

2. **今日のゴール**
   - 「手動で作る大変さ」を体験
   - 「AI支援の便利さ」を体験
   - 「どちらをいつ使うべきか」を理解

3. **データモデルの説明**
   ```
   PRODUCTS ←─ SALES
   （商品マスタ）  （売上データ）
   
   MARKETING_CAMPAIGN_METRICS ←─ SOCIAL_MEDIA
   （マーケティング）             （SNSデータ）
   ```

#### セットアップ（Step 0）

```sql
-- 参加者に実行してもらう
-- step0_setup.sql の内容
```

**チェックポイント**: 全員のテーブル作成が完了したか確認

---

### Step 1: 手動作成（0:15-0:45）

#### 講師の立ち位置

- **見守りモード**: 参加者に考えさせる
- **ヒントは最小限**: 苦労を体験してもらう
- **時間管理**: 30分で区切る（完成しなくてもOK）

#### 進行の流れ

| 時間 | 作業 | 講師アクション |
|------|------|---------------|
| 0:15-0:20 | テーブル選択・主キー設定 | 見守り |
| 0:20-0:30 | リレーションシップ設定 | 「どのカラムで結合しますか？」と問いかけ |
| 0:30-0:40 | ファクト・ディメンション設定 | 「売上金額はファクト？ディメンション？」 |
| 0:40-0:45 | メトリクス設定・完成 | 時間切れでも進める |

#### よくある質問と回答

| 質問 | 回答 |
|------|------|
| 「主キーがわからない」 | 「PRODUCTSならPRODUCT_IDが一意ですね」 |
| 「カーディナリティって？」 | 「1つの商品に複数の売上→Many-to-One」 |
| 「メトリクスの書き方は？」 | 「SUM(SALES_AMOUNT)のように集計関数を使います」 |

#### 演出ポイント

- **あえてヒントを出し惜しみ**して、苦労を実感させる
- **時間プレッシャー**を感じさせる（「あと5分です」）
- **完成しなくても大丈夫**と伝える（AI支援との比較が目的）

---

### Step 2: AI支援作成（0:45-0:55）

#### 2つの進め方

**パターンA: 講師デモ（推奨）**
- 講師が画面共有でAI支援を実演
- 参加者は見て驚きを体験
- 時間短縮できる

**パターンB: 参加者ハンズオン**
- 参加者が自分でAI支援を体験
- より深い理解が得られる
- 時間に余裕がある場合

#### デモの流れ（パターンA）

1. **テーブル選択**（同じ4テーブル）
2. **説明文入力**
   ```
   小売業の売上・マーケティングデータを分析するためのセマンティックビュー
   ```
3. **AI生成オプション有効化** ← ✨ポイント！
   - ☑️ 「Add AI-generated descriptions for tables and columns」
   - ☑️ 「Include sample values」
   - 「事前にカタログでメタデータを準備する必要はありません！」と強調
4. **サンプルSQL入力**（sample_queries.sqlから2-3個）
5. **「生成」クリック** → 「✨ 今、AIが分析しています...」
6. **結果確認** → 「リレーションシップも説明文も自動で生成されました！」

#### 強調ポイント

| Step 1で苦労した点 | AI支援での解決 |
|-------------------|---------------|
| 主キーの判断 | → 自動検出 |
| リレーションシップのカーディナリティ | → SQLから自動判定 |
| ファクト/ディメンション分類 | → 自動分類 |
| メトリクス計算式 | → SQLから自動生成 |
| テーブル/カラムの説明文 | → AI自動生成（事前準備不要！） |

#### 劇的効果を出すセリフ例

> 「Step 1で30分かかった作業が...」
> （「生成」クリック）
> 「...はい、2分で完成です！」

---

### 振り返り・Q&A（0:55-1:00）

#### 比較まとめ

| 観点 | 手動作成 | AI支援 |
|------|---------|--------|
| 時間 | 25-30分 | 10-15分 |
| 学び | 構成要素を深く理解 | 結果重視で効率的 |
| 推奨 | 学習目的、シンプル構造 | 実務、複雑構造 |

#### 締めの言葉

> 「手動作成は"セマンティックビューの構成要素を理解する"のに最適です。
> AI支援は"実務で素早く作る"のに最適です。
> 両方を知っているからこそ、適切に使い分けられます。」

---

## トラブルシューティング

| 症状 | 原因 | 対処 |
|------|------|------|
| Step 0でエラー | 権限不足 | ACCOUNTADMINで再実行 |
| テーブルが見えない | DB/スキーマ選択ミス | SV_HANDSON_DB.RETAILを確認 |
| AI支援が動かない | リージョン制限 | Cortexクロスリージョン設定を確認 |
| 参加者が迷子 | 進行が速い | 画面共有で現在地を示す |

---

## 事前準備チェックリスト

### 講師側

- [ ] デモ用アカウントでStep 0〜2を事前実行して動作確認
- [ ] 画面共有の準備（Snowsightを開いておく）
- [ ] sample_queries.sqlをコピペしやすい状態に
- [ ] タイマー準備（30分、10分、5分のアラート）

### 参加者側（事前アナウンス）

- [ ] Snowflakeトライアルアカウント作成
- [ ] ACCOUNTADMINロールでログイン可能か確認
- [ ] ハンズオン資材のURLを共有

---

## 補足資料

### セマンティックビューの構成要素（説明用）

```
セマンティックビュー
├── Tables（テーブル）
│   └── 主キー、シノニム、コメント
├── Relationships（リレーションシップ）
│   └── 結合カラム、カーディナリティ
├── Facts（ファクト）
│   └── 集計対象の数値カラム
├── Dimensions（ディメンション）
│   └── 分析軸（「〜別」で使うカラム）
└── Metrics（メトリクス）
    └── 計算式（SUM, AVG, DIV0など）
```

### AI支援が内部で行うこと

1. **SQLパース**: JOIN条件を抽出 → リレーションシップ生成
2. **カラム分析**: データ型と値を見て → ファクト/ディメンション分類
3. **集計関数抽出**: SUM/AVGなど → メトリクス生成
4. **カーディナリティ推定**: DISTINCT値をカウント → Many-to-One判定

---

## 質疑応答 想定Q&A

| 質問 | 回答 |
|------|------|
| クエリ履歴は参照される？ | はい、ただしトライアルでは履歴がないため、サンプルSQLで代用 |
| シノニム（同義語）は自動生成される？ | 一部自動提案されますが、日本語は手動追加推奨 |
| 作成後に編集できる？ | はい、GUIから編集可能 |
| Cortex Analystとの関係は？ | セマンティックビューはCortex Analystの「入力」になる |

---

## 参考リンク

- [セマンティックビュー概要](https://docs.snowflake.com/ja/user-guide/views-semantic/overview)
- [セマンティックビューUI操作](https://docs.snowflake.com/ja/user-guide/views-semantic/ui)
- [Cortex Analyst](https://docs.snowflake.com/ja/user-guide/snowflake-cortex/cortex-analyst/)

